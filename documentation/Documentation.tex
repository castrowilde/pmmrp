\documentclass[12pt,leqn]{article}

\title{Обработка на изображения чрез реакционно-дифузни модели}
\author{Пламен Никифоров, Християн Марков, Стефан Велинов}
\date{\today}

\usepackage[T2A]{fontenc}
\usepackage{amsmath,cmap}
\usepackage[cp1251]{inputenc}
\usepackage[english,bulgarian]{babel}
\usepackage{graphicx}
\usepackage{float}


\begin{document}
\maketitle

\tableofcontents

\section{Въведение}

В този проект представяме методи за обработка на изображения.
Използвайки реакционно-дифузен модел (и по-конкретно този на Fitz-Hugh \& Nagumo) при условията на Тюрингова нестабилност може да намираме ръбове на обекти, сегментираме изображения, намаляваме шума и увеличаваме контраста.
В сравнение с конвенционалните методи, предложеният тук дава по-добри резултати при наличие на шум.

\section{Дифузия}
Нека първо добием представа какво представлява дифузията. Най-просто казано дифузията е
процес, при който някакво вещество или енергия се разпространява от зони с по-висока концентрация,
към такива с по-ниска. Това явление се подчинява на едни и същи закони, независимо от същността на пренасяното вещество. За да стане по-ясно как точно работи дифузията разглеждаме
следните примери:

\begin{enumerate}
\item Представете си, че имаме метален прът и започнем да нагряваме
единия му край. Нагрятият край ще има по-висока концентрация на топлина и посредством дифузията, топлината
ще започне да се пренася по дължината на пръта, към края с по-ниска концентрация на топлина, до достигане на равновесно положение в което ще имаме една и съща температура по целия прът.

\item Нека имаме аквариум пълен с вода. Пускайки количество мастило в аквариума, ние увеличаваме концентрацията на мастило там, където сме го пуснали спрямо останалата част на аквариума. Мастилото ще започне да се разнася към тези части с по-ниска концентрация, до достигане на положение, в което концентрацията на мастило във водата е равномерно разпределена.
\end{enumerate}

Вече имайки тази интуитивна представа за това какво представлява дифузията, нека разгледаме процеса по-строго от научна гледна точка и да го опишем математически. За да постигнем тази цел, ще трябва да разгледаме \textit{Закона за запазване на енергията} и \textit{Закона на Фик}.

\section{Реакция}

\section{Реакционно-дифузни системи}
Реакционно-дифузните системи са математически модели, които описват няколко физически явления: най-честосрещаният от които е промяната във времето и пространството на конценцтрацията на едно или повече вещества. Локални реакции карат субстанциите да се изменят една към друга, а дифузията ги разпространява из пространството.

Такива системи се използват предимно в химията, но могат да опишат и динамични процеси от други природни области. Примери могат да се намерят в биологията, геологията, физиката, екологията и т.н. Математически погледнато, реакционно-дифузните системи са линейни параболични частни диференциални уравнения. Решенията им пък описват различни поведения - например вълни, себе-организиращи се структури като ивици, шестоъгълници или по-сложни.

\subsection{Двукомпонентни системи}

Двукомпонентните системи позволяват описване на много по-голям диапазон феномени, за разлика от еднокомпонентния си аналог. Една от най-важните идеи, свързани с тях, е предложена от Алан Тюринг. Той твърди, че едно състояние, което е стабилно в локална система, може да изгуби това си качество при наличието на дифузия.

Разглежданите в този проект системи са активатор-инхибиторните, в които един компонент стимулира собственото си и на другите компоненти възпроизвеждане, а другия инхибира (възпира) растежа им. Най-известният представител е уравнението на FitzHugh-Nagumo, който е представен в \ref{sec:FHN}
%
%\begin{equation}
%\begin{split}
%\partial_t u &=  d_u^2 \nabla^2u + f(u) - \sigma \upsilon, \\
%\tau \partial_t \upsilon &= d_\upsilon^2 \nabla^2\upsilon + u - \upsilon,
%\end{split}
%\end{equation}
%където $d_u, d_v, \tau, \sigma, \lambda$ са положителни константи.

\section{Оформяне на образи}

Науката на оформянето на образи (англ.: \textit{pattern formation}) се занимава с процесите, които водят до създаването на образи и структури, подобни на тези в природата.

\begin{figure}[h]
\centering
\includegraphics[scale=0.7]{patternformationexample.jpg}
\caption{Структура, наподобяваща реакционно-дифузен модел}
\end{figure}

Съществуват редица автоматизирани методи за създаване на органично изглеждащи текстури и триизмерни обекти.
Много често компютри се използват за симулиране на биологични, физични или химични процеси, които водят до оформяне на образи и визуализирането им. Най-често срещаните модели за тази цел са реакционно-дифузните и MClone.

\section{Постановка на задачата}

\subsection{Модел на FitzHugh-Nagumo}\label{sec:FHN}

Моделът на FitzHugh-Nagumo (FHN) е опростена версия на модела на Hodgkin-Huxley, който описва детайлно активацията и деактивацията на неврони.

Този модел се задава чрез уравненията

\begin{equation}
\begin{split}
\frac{\partial u}{\partial t} &= D_{u} \nabla^2 u + \frac{1}{\varepsilon}\cdot u(1-u)(u-a)-v)\label{eq:1}\\
\frac{\partial v}{\partial t} &= D_{v} \nabla^2 v + u -bv,
\end{split}
\end{equation}
където $u$ и $v$ са концентрациите на активатор и инхибитор, $D_u$ и $D_v$ са съответните коефициенти на дифузия, а $\varepsilon (0 < \varepsilon << 1), a (0 < a < 0.5)$ и $b (b > 0)$ са константни параметри.

Уравненията \ref{eq:1} определят поведението на $u$ и $v$ с течение на времето.

\subsection{Поведение на елементите}

В нашия случай, елементите (пикселите на изображението) са разпределени в мрежа. Всеки елемент се състои от две субстанции. Единият е активаторът, а другият е инхибиторът. При стабилно състояние, елементите крепят баланса на концентрациите на двете субстанции. Но, при добавяне на дори малък стимул, равновесието се губи. Ако стимулът е над определена граница, концентрацията на активатора се увеличава автоматично с времето.

Сега ще проверим поведението на модела в стабилно състояние $( \frac{\partial u}{\partial t} = 0, \frac{\partial v}{\partial t} = 0)$, без да прилагаме дифузията (т.е. $D_u = 0, D_v = 0$). Тогава получаваме следните изоклини:

\begin{equation}
\begin{split}
v &= u (1 - u)(u - a),\\
v &= (1/b)u
\end{split}
\end{equation}

\begin{figure}[H]
\centering
\includegraphics[scale=0.3]{Capturemonostable.png}
\caption{Моноустойчива система}
\includegraphics[scale=0.3]{Capturebistable.png}
\caption{Двуустойчива}
\label{fig:nullclines}
Изоклини на уравненията на модела на FitzHugh-Nagumo
\end{figure}

Фигура \ref{fig:nullclines} показва изоклините на уравненията в модела. Поведението на $u$ и $v$ е различно в зависимост от това в коя област са. В пресечната точка изменението на $u$ и $v$ е статично (те се зануляват едно друго). В зависимост от стойностите на константите $a$ и $b$, броят на устойчиви точки се мени и система показва различни типове. Един от тях е моноустойчивия (с една стабилна точка), другият е двуустойчивия (с две). При първия, състоянието се променя след добавяне на стимул, но в крайна сметка се връща към стабилно по посока на стрелките. От друга страна, двуустойчивата система има три устойчиви точки. Ако стимулът е над границата $(u > a, v = 0)$ елементът отива в състояние $B$, в другия случай $(u < a, v = 0)$ отива към $A$. В точка $C$ нямаме стабилност, затова тази точка се нарича нестабилна устойчива точка.

\begin{figure}[H]
\centering
\includegraphics[scale=0.3]{evolutions.png}
\caption{Разликата в поведението при добавяне на различни стойности на стимула}
\label{fig:evolutions}
\end{figure}

Фигура \ref{fig:evolutions} изобразява разликата в поведението на моноустойчивата система, при добавяне на различна стойност на стимула. При $u > a, v = 0$, орбитата стига линията (1), а накрая $u$ и $v$ достигат състоянието $A$. В другиш случай $(u < a, v = 0)$, орбита стига линията (2). Така откриваме, че параметърът $a$ от \ref{eq:1} действа като граница (\textit{threshold}).
\end{document}
